package com.channelsoft.ccod.recordmanager.monitor.dao.impl;

import com.channelsoft.ccod.recordmanager.config.BuzOracleCondition;
import com.channelsoft.ccod.recordmanager.config.CallCheckRule;
import com.channelsoft.ccod.recordmanager.constant.RecordType;
import com.channelsoft.ccod.recordmanager.monitor.dao.IRecordDetailDao;
import com.channelsoft.ccod.recordmanager.monitor.po.BakRecordIndex;
import com.channelsoft.ccod.recordmanager.monitor.vo.RecordDetailVo;
import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Conditional;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Component;

import javax.annotation.PostConstruct;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.stream.Collectors;

/**
 * @ClassName: RecordDetailDaoImpl
 * @Author: lanhb
 * @Description: 普通平台的IRecordlDetailDao接口实现类，适用ucds库为mysql，业务库为单一oracle场景
 * @Date: 2020/4/4 13:15
 * @Version: 1.0
 */
@Conditional(BuzOracleCondition.class)
@Component(value = "recordDetailDao")
public class RecordDetailDaoImpl implements IRecordDetailDao {

    private final static Logger logger = LoggerFactory.getLogger(RecordDetailDaoImpl.class);

    @Autowired
    JdbcTemplate businessJdbcTemplate;

    @Value("${ccod.recordType}")
    private RecordType recordType;

    @Value("${db.table.detail}")
    private String detailTable;

    @Value("${db.table.mix}")
    private String mixTable;

    @Value("${db.table.combination}")
    private String combinationTable;

    @Value("${db.table.bak}")
    private String bakTable;

    @Value("${ccod.hasBak}")
    private boolean hasBak;

    @Value("${debug}")
    private boolean debug;

    @Autowired
    CallCheckRule callCheckRule;

    protected String[] testIndexes = ("0000099999/Agent/20190814/TEL-01057040278_1445_20200304100034.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304100254.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304100659.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304100727.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304100900.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101003.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101034.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101059.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101141.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101224.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101258.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101340.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101400.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101505.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101540.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101605.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101627.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101752.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101925.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304101955.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304102113.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304102135.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304103009.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304103552.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105221.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105354.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105646.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105801.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105826.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105855.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304105954.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304110555.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304110703.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304110745.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304110830.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111046.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111425.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111515.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111635.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111719.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111811.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111838.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111916.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304111949.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304112106.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304112221.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304112326.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304112731.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304112855.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304113439.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304113549.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304113701.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304113813.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130406.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130441.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130520.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130621.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130729.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130801.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130845.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304130946.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131019.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131032.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131101.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131114.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131157.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131234.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131258.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131404.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131721.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304131803.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304132127.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304132140.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304132227.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304132847.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304132921.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133001.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133102.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133151.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133255.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133430.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133541.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133619.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133725.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133834.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133919.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304133946.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134106.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134131.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134235.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134307.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134408.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134442.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134536.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134705.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304134736.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304135042.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304135133.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304135215.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304135329.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304135433.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304135825.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304140549.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304140635.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304140722.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304141311.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304141401.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304141519.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304141637.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304141817.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304141938.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142020.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142104.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142252.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142618.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142742.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142827.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142858.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304142927.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304143006.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304143054.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304143306.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304143600.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304143721.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304144155.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304144258.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304144339.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304145131.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304145417.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304145525.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304145731.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304145831.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304150341.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304150434.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304150513.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304150703.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304151144.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304151434.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304151551.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304152020.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304152120.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304152457.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304160035.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304160131.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304160215.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304160551.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304161328.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304161505.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304161707.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304162144.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304162446.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304162631.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304163234.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304163325.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304163414.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304163651.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304163839.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304163921.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304164515.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304164648.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304164830.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304165012.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304165129.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304165149.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304165432.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304165556.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304165813.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304170456.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304170521.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304170628.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304170654.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304170737.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304170843.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040278_1445_20200304171805.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304100734.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304101106.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304101908.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304101935.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304101956.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304102226.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304102242.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304102451.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304102519.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304102525.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304103050.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304103127.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304103835.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304104717.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304104811.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304104838.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304104918.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105111.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105402.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105447.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105503.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105747.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105824.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304105953.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304110740.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304110831.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304111052.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304111417.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304111432.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304111741.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304112128.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304112538.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304112717.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130307.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130325.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130414.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130433.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130535.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130554.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130602.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304130946.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304131019.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304131036.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132132.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132202.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132216.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132242.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132249.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132421.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132552.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132632.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304132935.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133021.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133055.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133451.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133619.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133710.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133734.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133757.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133828.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133910.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304133933.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304135537.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304135637.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304161130.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304161702.wav\n" +
            "0000099999/Agent/20190814/TEL-01057040288_1446_20200304161746.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304100941.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101027.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101103.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101156.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101327.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101412.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101536.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101610.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101728.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304101922.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102014.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102055.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102118.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102320.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102608.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102719.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102845.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102924.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304102954.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304103018.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304103101.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130107.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130140.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130248.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130350.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130442.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130603.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130645.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304130734.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304165415.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304165429.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304165547.wav\n" +
            "0000099999/Agent/20190814/TEL-01061496827_1467_20200304165802.wav\n" +
            "0000099999/Agent/20190814/TEL-01088822337_8888_20200304100148.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304101427.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304101452.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304101521.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304101643.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304101718.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304101808.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304102628.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304102824.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304102934.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103006.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103141.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103300.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103347.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103510.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103532.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103653.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103722.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103754.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304103928.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104012.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104134.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104327.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104409.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104432.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104521.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304104700.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125344.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125407.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125439.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125523.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125554.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125616.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125748.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125813.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125839.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304125927.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304130102.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304130150.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304130235.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304130322.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165246.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165312.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165337.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165424.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165503.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165549.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165725.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165816.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165906.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304165950.wav\n" +
            "0000099999/Agent/20190814/TEL-01089456813_1460_20200304170054.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304100607.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304100914.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101024.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101115.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101350.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101441.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101525.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101607.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101653.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101838.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304101922.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304102308.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304102358.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304102428.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304102508.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304102808.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103232.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103324.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103603.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103722.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103755.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103823.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304103900.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104020.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104113.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104410.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104438.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104611.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104751.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304104921.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105059.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105224.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105323.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105413.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105506.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105732.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105845.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105920.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304105944.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110038.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110116.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110158.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110226.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110421.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110507.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110641.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110712.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110843.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304110931.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304111009.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304111055.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304111401.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304111512.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304112907.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113050.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113129.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113249.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113403.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113452.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113533.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113749.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113853.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304113941.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114019.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114052.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114138.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114431.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114500.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114543.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114647.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114733.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114805.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114828.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304114926.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115020.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115045.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115150.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115430.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115457.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115525.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115637.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304115713.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130151.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130222.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130326.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130406.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130516.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130552.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130718.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130901.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304130941.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131053.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131133.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131249.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131321.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131554.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131620.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131642.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131709.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131822.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131847.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304131916.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132127.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132227.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132330.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132443.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132516.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132719.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304132748.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133042.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133350.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133452.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133519.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133551.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133632.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133742.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133817.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304133912.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134018.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134050.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134115.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134137.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134337.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134428.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134453.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134554.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134703.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134806.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134831.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134910.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304134938.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135015.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135124.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135153.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135223.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135242.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135306.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135325.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135343.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135450.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135517.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304135555.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304141226.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304141248.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304141404.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304142500.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304142620.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304142839.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304142912.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143044.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143131.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143400.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143523.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143619.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143644.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143747.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143819.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143848.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143912.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304143941.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304144038.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304144132.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304144310.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304144543.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304144621.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304153458.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304153528.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304153814.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304153901.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154004.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154036.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154105.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154141.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154220.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154255.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154412.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154450.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154519.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154543.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154604.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154706.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154807.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154843.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304154914.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304155020.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304155223.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304155256.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304155605.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304155632.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304160525.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304160550.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304160657.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304160746.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304160812.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304160842.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161134.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161231.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161256.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161355.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161415.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161617.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161643.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161703.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161733.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161925.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304161952.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162105.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162135.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162208.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162316.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162352.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162415.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162435.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162452.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162517.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162541.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162614.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162650.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304162726.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304163000.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304163020.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304163058.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165347.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165423.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165510.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165612.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165642.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165702.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165718.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165751.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165810.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304165910.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170012.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170042.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170246.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170313.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170359.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170539.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170646.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304170901.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171030.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171211.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171240.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171439.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171500.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171532.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171611.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171656.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171835.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304171933.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172018.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172153.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172340.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172401.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172445.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172512.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172656.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172757.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304172906.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173107.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173147.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173218.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173256.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173558.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173703.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304173805.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304174008.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304174038.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304174138.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304174350.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304174616.wav\n" +
            "0000099999/Agent/20190814/TEL-051687338914_1500_20200304174654.wav\n").split("\n");

    @PostConstruct
    public void init()
    {
        System.out.println("$$$$$$$$$$$$$$$$$$$$$$$$");
    }

    @Override
    public List<RecordDetailVo> select(String schemaName, Date beginTime, Date endTime) {
        if(debug)
        {
            Calendar ca = Calendar.getInstance();
            ca.set(Calendar.YEAR, 2019);
            ca.set(Calendar.MONTH, 7);
            ca.set(Calendar.DATE, 14);
            ca.set(Calendar.SECOND, 0);
            ca.set(Calendar.MILLISECOND, 0);
            beginTime = ca.getTime();
            ca.add(Calendar.MINUTE, 40);
            endTime = ca.getTime();
        }
        String sql = generateSql(schemaName, beginTime, endTime);
        logger.debug(String.format("begin to query %s record detail with type=%s from %s to %s, sql=%s",
                schemaName, this.recordType, beginTime, endTime, sql));
        List<RecordDetailVo> retList = this.businessJdbcTemplate.query(sql, new MapRow());
        logger.debug(String.format("%s has %d record from %s to %s with type=%s",
                schemaName, retList.size(), beginTime, endTime, this.recordType.name));
        if(debug)
        {
            int len = this.testIndexes.length;
            for(int i = 0; i < retList.size(); i++)
            {
                if(i < len)
                {
                    retList.get(i).setRecordIndex(this.testIndexes[i]);
                    retList.get(i).setBakRecordIndex("0000000018/202004/10086/0415/20200415075510_1271_8025016844987477774_10086.wav");
                }
            }
        }
        return retList;
    }



    private String generateSql(String schemaName, Date beginTime, Date endTime)
    {
        StringBuffer sql = new StringBuffer();
        sql.append("SELECT ");
        sql.append("RD.SESSION_ID AS SESSION_ID,");
        sql.append("RD.START_TIME AS START_TIME,");
        sql.append("RD.END_TIME AS END_TIME,");
        sql.append("RD.AGENT_ID AS AGENT_ID,");
        sql.append("RD.TALK_DURATION AS TALK_DURATION,");
        sql.append("RD.END_TYPE AS END_TYPE,");
        sql.append("RD.CALLTYPE AS CALLTYPE");
        switch (this.recordType)
        {
            case MIX:
                sql.append(",ERT.RECORD_NAME AS RECORD_INDEX");
                break;
            case COMBINATION:
                sql.append(",ERBT.RECORD_NAME AS RECORD_INDEX");
                break;
            case MIX_AND_COMBINATION:
                sql.append(",ERT.RECORD_NAME AS MIX_RECORD_INDEX");
                sql.append(",ERBT.RECORD_NAME AS COMBINATION_RECORD_INDEX");
                break;
        }
        if (this.hasBak)
        {
            sql.append(",BRT.RECORD_NAME AS RECORD_INDEX_BAK");
        }
        sql.append(" FROM \"").append(schemaName).append("\".").append(this.detailTable)
                .append(" RD");
        switch (this.recordType)
        {
            case MIX:
                sql.append(" LEFT JOIN \"").append(schemaName).append("\".")
                        .append(this.mixTable).append(" ERT");
                sql.append(" ON RD.SESSION_ID = ERT.SESSION_ID AND ((RD.AGENT_ID = ERT.AGENT_ID) OR (RD.AGENT_ID IS NULL and ERT.AGENT_ID IS NULL))");
                break;
            case COMBINATION:
                sql.append(" LEFT JOIN \"").append(schemaName).append("\".")
                        .append(this.combinationTable).append(" ERBT");
                sql.append(" ON RD.SESSION_ID = ERBT.SESSION_ID AND ((RD.AGENT_ID = ERBT.AGENT_ID) OR (RD.AGENT_ID IS NULL and ERBT.AGENT_ID IS NULL))");
                break;
            case MIX_AND_COMBINATION:
                sql.append(" LEFT JOIN \"").append(schemaName).append("\".")
                        .append(this.mixTable).append(" ERT");
                sql.append(" ON RD.SESSION_ID = ERT.SESSION_ID AND ((RD.AGENT_ID = ERT.AGENT_ID) OR (RD.AGENT_ID IS NULL and ERT.AGENT_ID IS NULL))");
                sql.append(" LEFT JOIN \"").append(schemaName).append("\".")
                        .append(this.combinationTable).append(" ERBT");
                sql.append(" ON RD.SESSION_ID = ERBT.SESSION_ID AND ((RD.AGENT_ID = ERBT.AGENT_ID) OR (RD.AGENT_ID IS NULL and ERBT.AGENT_ID IS NULL))");
                break;
        }
        if (this.hasBak)
        {
            sql.append(" LEFT JOIN \"").append(schemaName).append("\".")
                    .append(this.bakTable).append(" BRT");
            sql.append(" ON RD.SESSION_ID = BRT.SESSION_ID AND RD.AGENT_ID = BRT.AGENT_ID");
        }
        SimpleDateFormat sFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
//		 sql.append(" WHERE 1=1 ");
        sql.append(" WHERE 1=1 AND RD.TALK_DURATION > ")
                .append(this.callCheckRule.getMinTalkDuration())
                .append(" AND RD.END_TIME >= to_date('")
                .append(sFormat.format(beginTime))
                .append("','yyyy-MM-dd HH24:mi:ss') AND RD.END_TIME < to_date('")
                .append(sFormat.format(endTime))
                .append("','yyyy-MM-dd HH24:mi:ss')");
        if (this.callCheckRule.getCallTypes() != null && this.callCheckRule.getCallTypes().size() > 0)
        {
            sql.append(" AND (RD.CALLTYPE=").append(this.callCheckRule.getCallTypes().get(0));
            for (int i = 1; i < this.callCheckRule.getCallTypes().size(); i++)
            {
                sql.append(" OR RD.CALLTYPE=").append(this.callCheckRule.getCallTypes().get(i));
            }
            sql.append(")");
        }
        if (this.callCheckRule.getEndTypes() != null && this.callCheckRule.getEndTypes().size() > 0)
        {
            sql.append(" AND (RD.END_TYPE=").append(this.callCheckRule.getEndTypes().get(0));
            for (int i = 1; i < this.callCheckRule.getEndTypes().size(); i++)
            {
                sql.append(" OR RD.END_TYPE=").append(this.callCheckRule.getEndTypes().get(i));
            }
            sql.append(")");
        }
        return sql.toString();
    }

    @Override
    public List<BakRecordIndex> select(String entId, List<String> sessionIds) {
        String sql = String.format("select * from \"%s\".%s where SESSION_ID IN(%s)",
                entId, this.bakTable, sessionIds.stream().map(id->String.format("'%s'",id)).collect(Collectors.joining(",")));
        logger.debug(String.format("begin to query bak record index, sql=%s", sql));
        List<BakRecordIndex> list = this.businessJdbcTemplate.query(sql, new BakRecordIndexRowMap(entId));
        logger.debug(String.format("find %d bak record index record", list.size()));
        return list;
    }

    private class MapRow implements RowMapper<RecordDetailVo>
    {

        @Override
        public RecordDetailVo mapRow(ResultSet rs, int i) throws SQLException
        {
            RecordDetailVo detailVo = new RecordDetailVo();
            detailVo.setRecordType(recordType);
            detailVo.setSessionId(rs.getString("SESSION_ID"));
            detailVo.setStartTime(rs.getTimestamp("START_TIME"));
            detailVo.setEndTime(rs.getTimestamp("END_TIME"));
            detailVo.setAgentId(rs.getString("AGENT_ID"));
            detailVo.setTalkDuration(rs.getInt("TALK_DURATION"));
            detailVo.setEndType(rs.getInt("END_TYPE"));
            detailVo.setCallType(rs.getInt("CALLTYPE"));
            switch (recordType)
            {
                case MIX:
                case COMBINATION:
                    detailVo.setRecordIndex(rs.getString("RECORD_INDEX"));
                    break;
                case MIX_AND_COMBINATION:
                    String mixIndex = rs.getString("MIX_RECORD_INDEX");
                    String combinationIndex = rs.getString("COMBINATION_RECORD_INDEX");
                    if(StringUtils.isNotBlank(mixIndex)) {
                        detailVo.setRecordType(RecordType.MIX);
                        detailVo.setRecordIndex(mixIndex);
                    }
                    else if(StringUtils.isNotBlank(combinationIndex)) {
                        detailVo.setRecordType(RecordType.COMBINATION);
                        detailVo.setRecordIndex(combinationIndex);
                    }
                    else {
                        logger.warn("MIX_RECORD_INDEX and COMBINATION_RECORD_INDEX of %s is blank");
                    }
                    break;
            }
            detailVo.setHasBak(hasBak);
            if (hasBak)
            {
                detailVo.setBakRecordIndex(rs.getString("RECORD_INDEX_BAK"));
            }
            return detailVo;
        }
    }

    class BakRecordIndexRowMap implements RowMapper<BakRecordIndex> {
        String entId;
        BakRecordIndexRowMap(String entId) {
            this.entId = entId;
        }
        @Override
        public BakRecordIndex mapRow(ResultSet rs, int i) throws SQLException {
            SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
            BakRecordIndex po = new BakRecordIndex();
            po.setRecordName(rs.getString("RECORD_NAME"));
            po.setEntId(entId);
            po.setSessionId(rs.getString("SESSION_ID"));
            po.setRemoteUri(rs.getString("REMOTE_URI"));
            po.setLocalUri(rs.getString("LOCAL_URI"));
            po.setAgentId(rs.getString("AGENT_ID"));
            po.setCmsName(rs.getString("CMS_NAME"));
            po.setCallType(rs.getInt("CALL_TYPE"));
            po.setDeviceNumber(rs.getString("DEVICE_NUMBER"));
            try {
                po.setStartTime(sf.parse(rs.getString("START_TIME")));
                po.setEndTime(sf.parse(rs.getString("END_TIME")));
            } catch (Exception ex) {
                logger.error("parse start or end time error", ex);
            }
            try {
                po.setCtiStartTime(sf.parse(rs.getString("CTI_START_TIME")));
                po.setCtiEndTime(sf.parse(rs.getString("CTI_END_TIME")));
            } catch (Exception ex) {
                logger.error("parse cti start or end time error", ex);
            }
            po.setSkillName(rs.getString("SKILL_NAME"));
            return po;
        }
    }
}
